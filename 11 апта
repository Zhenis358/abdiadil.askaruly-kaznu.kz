import socket

def perform_operation(operation, num1, num2):
    if operation == '+':
        return num1 + num2
    elif operation == '-':
        return num1 - num2
    elif operation == '*':
        return num1 * num2
    elif operation == '/':
        if num2 == 0:
            return "Ошибка: деление на ноль"
        return num1 / num2
    else:
        return "Неизвестная операция"

def start_server(host='127.0.0.1', port=65432):
    # Создаем серверный сокет
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as server_socket:
        server_socket.bind((host, port))
        server_socket.listen()
        print(f"Сервер запущен на {host}:{port}")

        while True:
            # Ожидаем подключения клиента
            conn, addr = server_socket.accept()
            with conn:
                print(f"Подключен клиент: {addr}")

                # Отправляем клиенту доступные операции
                available_operations = "+, -, *, /"
                conn.sendall(available_operations.encode())

                # Получаем запрос от клиента (команда и числа)
                data = conn.recv(1024).decode()
                if not data:
                    break

                # Разбираем команду
                try:
                    operation, num1, num2 = data.split()
                    num1, num2 = float(num1), float(num2)
                    result = perform_operation(operation, num1, num2)
                except ValueError:
                    result = "Ошибка: неверный формат данных"
                
                # Отправляем результат обратно клиенту
                conn.sendall(str(result).encode())

if __name__ == "__main__":
    start_server()
